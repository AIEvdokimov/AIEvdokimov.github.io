<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –î–∞—à–±–æ—Ä–¥ - aievdokimov</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- ECharts –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <!-- jsPDF –¥–ª—è PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Day.js –¥–ª—è –¥–∞—Ç -->
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .navbar { box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .card { box-shadow: 0 4px 20px rgba(0,0,0,0.1); border: none; }
        #chart { height: 400px; border-radius: 10px; }
        .stat-card { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); }
    </style>
</head>
<body>
    <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">üè† –ì–ª–∞–≤–Ω–∞—è</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">üìã –ó–∞–¥–∞—á–∏</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="dashboard.html">üìä –î–∞—à–±–æ—Ä–¥</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <!-- –ó–ê–ì–û–õ–û–í–û–ö -->
        <div class="text-center mb-5">
            <h1 class="display-4 fw-bold text-white mb-3">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –î–∞—à–±–æ—Ä–¥</h1>
            <p class="lead text-white-50">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ DVD Rental 2026</p>
        </div>

        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="row mb-5">
            <div class="col-md-3 mb-4">
                <div class="card stat-card p-4 text-center">
                    <h2 class="text-primary">1,247</h2>
                    <p class="mb-0 fw-bold">–§–∏–ª—å–º–æ–≤</p>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card stat-card p-4 text-center">
                    <h2 class="text-success">‚Çπ 456,780</h2>
                    <p class="mb-0 fw-bold">–í—ã—Ä—É—á–∫–∞</p>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card stat-card p-4 text-center">
                    <h2 class="text-info">599</h2>
                    <p class="mb-0 fw-bold">–ö–ª–∏–µ–Ω—Ç–æ–≤</p>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card stat-card p-4 text-center">
                    <h2 class="text-warning">94%</h2>
                    <p class="mb-0 fw-bold">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å</p>
                </div>
            </div>
        </div>

        <!-- –û–°–ù–û–í–ù–û–ô –î–ê–®–ë–û–†–î -->
        <div class="row">
            <!-- –ì–†–ê–§–ò–ö -->
            <div class="col-md-8 mb-4">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5>–í—ã—Ä—É—á–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º</h5>
                    </div>
                    <div class="card-body p-0">
                        <div id="revenueChart"></div>
                    </div>
                </div>
            </div>

            <!-- –£–ü–†–ê–í–õ–ï–ù–ò–ï -->
            <div class="col-md-4 mb-4">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h6>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h6>
                    </div>
                    <div class="card-body">
                        <button onclick="addRandomDeal()" class="btn btn-outline-primary w-100 mb-2">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–¥–µ–ª–∫—É
                        </button>
                        <button onclick="exportPDF()" class="btn btn-outline-info w-100 mb-2">
                            üìÑ –≠–∫—Å–ø–æ—Ä—Ç PDF
                        </button>
                        <button onclick="resetData()" class="btn btn-outline-warning w-100">
                            üîÑ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
                        </button>
                    </div>
                </div>

                <!-- –ü–û–°–õ–ï–î–ù–ò–ï –°–î–ï–õ–ö–ò -->
                <div class="card mt-4">
                    <div class="card-header bg-info text-white">
                        <h6>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏</h6>
                    </div>
                    <div class="card-body p-3">
                        <div id="recentDeals"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // –î–ê–ù–ù–´–ï (localStorage)
    let dashboardData = JSON.parse(localStorage.getItem('dashboardData')) || {
        deals: [
            { client: '–ò–≤–∞–Ω–æ–≤ –ü.', sum: 1250, date: dayjs().subtract(1, 'day').format('DD.MM') },
            { client: '–ü–µ—Ç—Ä–æ–≤ –ê.', sum: 890, date: dayjs().subtract(2, 'days').format('DD.MM') },
            { client: '–°–∏–¥–æ—Ä–æ–≤–∞ –ú.', sum: 2100, date: dayjs().subtract(3, 'days').format('DD.MM') }
        ],
        revenue: [12000, 15000, 18000, 16500, 22000, 19800]
    };

    function saveData() {
        localStorage.setItem('dashboardData', JSON.stringify(dashboardData));
    }

    function initCharts() {
        // –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Ä—É—á–∫–∏
        const revenueChart = echarts.init(document.getElementById('revenueChart'));
        revenueChart.setOption({
            tooltip: { trigger: 'axis' },
            title: { text: '–í—ã—Ä—É—á–∫–∞, ‚ÇΩ', left: 'center' },
            grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
            xAxis: { type: 'category', data: ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω'] },
            yAxis: { type: 'value' },
            series: [{
                name: '–í—ã—Ä—É—á–∫–∞',
                type: 'line',
                data: dashboardData.revenue,
                smooth: true,
                lineStyle: { color: '#0d6efd', width: 3 },
                itemStyle: { color: '#0d6efd' }
            }]
        });
    }

    function updateRecentDeals() {
        const container = document.getElementById('recentDeals');
        container.innerHTML = dashboardData.deals.slice(-5).map(deal => `
            <div class="d-flex justify-content-between align-items-center p-2 border-bottom">
                <span>${deal.client}</span>
                <span class="fw-bold text-success">‚Çπ ${deal.sum}</span>
            </div>
        `).join('');
    }

    function addRandomDeal() {
        const clients = ['–û–û–û –†–æ–º–∞—à–∫–∞', '–ò–ü –ü–µ—Ç—Ä–æ–≤', '–ó–ê–û –ó–≤–µ–∑–¥–∞', '–¢–û–í –¢—Ä–∏—É–º—Ñ'];
        const sums = [750, 1200, 890, 1560, 2100, 980];
        
        dashboardData.deals.unshift({
            client: clients[Math.floor(Math.random() * clients.length)],
            sum: sums[Math.floor(Math.random() * sums.length)],
            date: dayjs().format('DD.MM')
        });
        
        if (dashboardData.deals.length > 50) dashboardData.deals.pop();
        saveData();
        updateRecentDeals();
    }

    function exportPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        doc.setFontSize(20);
        doc.text('–û—Ç—á—ë—Ç DVD Rental CRM', 20, 20);
        doc.setFontSize(12);
        doc.text(`–î–∞—Ç–∞: ${dayjs().format('DD.MM.YYYY')}`, 20, 35);
        
        let y = 50;
        dashboardData.deals.slice(0, 10).forEach((deal, i) => {
            doc.text(`${i+1}. ${deal.client} ‚Äî ‚Çπ ${deal.sum}`, 20, y);
            y += 8;
        });
        
        doc.text(`–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫: ${dashboardData.deals.length}`, 20, y + 10);
        doc.save(`crm-report-${dayjs().format('YYYY-MM-DD')}.pdf`);
    }

    function resetData() {
        if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?')) {
            dashboardData = { deals: [], revenue: [0,0,0,0,0,0] };
            saveData();
            updateRecentDeals();
            location.reload();
        }
    }

    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
    document.addEventListener('DOMContentLoaded', () => {
        initCharts();
        updateRecentDeals();
    });
    </script>
</body>
</html>
